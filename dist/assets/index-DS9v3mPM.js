import{r,a as Me,u as Te,B as Re,R as Pe,b as oe,d as De}from"./react-40xKZDbB.js";import{P as D}from"./phaser-C-vkKDMm.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(o){if(o.ep)return;o.ep=!0;const n=s(o);fetch(o.href,n)}})();var ye={exports:{}},ne={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Be=r,$e=Symbol.for("react.element"),Fe=Symbol.for("react.fragment"),Ge=Object.prototype.hasOwnProperty,Ke=Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,qe={key:!0,ref:!0,__self:!0,__source:!0};function Ee(a,e,s){var i,o={},n=null,l=null;s!==void 0&&(n=""+s),e.key!==void 0&&(n=""+e.key),e.ref!==void 0&&(l=e.ref);for(i in e)Ge.call(e,i)&&!qe.hasOwnProperty(i)&&(o[i]=e[i]);if(a&&a.defaultProps)for(i in e=a.defaultProps,e)o[i]===void 0&&(o[i]=e[i]);return{$$typeof:$e,type:a,key:n,ref:l,props:o,_owner:Ke.current}}ne.Fragment=Fe;ne.jsx=Ee;ne.jsxs=Ee;ye.exports=ne;var t=ye.exports,pe={},fe=Me;pe.createRoot=fe.createRoot,pe.hydrateRoot=fe.hydrateRoot;const Q=["Mols","Dzintars","Teatris","Kanals","Osta","LSEZ","Cietums","RTU","Ezerkrasts","Parks"],te=Q.length,ie="_gs",ae="_gameStart";function Z(a,e){return(a*7+e*13+42^42405)>>>0}class Ue{constructor(){this._score=0,this._completedTasks=0,this._checksum=Z(0,0)}_verify(){return this._checksum===Z(this._score,this._completedTasks)}_fix(){this._score=0,this._completedTasks=0,this._checksum=Z(0,0)}getScore(){return this._verify()||this._fix(),this._score}addScore(e){return this._verify()||this._fix(),this._score=Math.max(0,Math.min(100,this._score+e)),this._checksum=Z(this._score,this._completedTasks),this._persist(),this._score}getCompleted(){return this._verify()||this._fix(),this._completedTasks}completeTask(){return this._verify()||this._fix(),this._completedTasks=Math.min(te,this._completedTasks+1),this._checksum=Z(this._score,this._completedTasks),this._persist(),this._completedTasks}reset(){this._score=0,this._completedTasks=0,this._checksum=Z(0,0);try{sessionStorage.removeItem(ie),sessionStorage.removeItem(ae)}catch{}}restore(e,s){this._score=Math.max(0,Math.min(100,e)),this._completedTasks=Math.max(0,Math.min(te,s)),this._checksum=Z(this._score,this._completedTasks)}_persist(){try{sessionStorage.setItem(ie,JSON.stringify({s:this._score,c:this._completedTasks}))}catch{}}loadFromSession(){try{const e=sessionStorage.getItem(ie);if(!e)return!1;const{s,c:i}=JSON.parse(e);if(typeof s=="number"&&typeof i=="number")return this.restore(s,i),!0}catch{}return!1}getStartTime(){try{const e=sessionStorage.getItem(ae);if(e)return parseInt(e,10)}catch{}return null}saveStartTime(e){try{sessionStorage.setItem(ae,String(e))}catch{}}clearSession(){try{sessionStorage.removeItem(ie),sessionStorage.removeItem(ae)}catch{}}}const q=new Ue,Ve={low:1,medium:3,critical:8},He=15,We=500,Ze=1500,Je=200,Xe=4;class Ye{constructor(){this._sessionId=this._generateSessionId(),this._violations=0,this._violationLog=[],this._suspended=!1,this._taskStartTime=null,this._lastTaskEndTime=null,this._answerTimings=[],this._mouseMovements=[],this._keyEvents=[],this._hasUserInteracted=!1,this._chainHash=0,this._actionLog=[],this._fingerprint=null,this._lastSubmitTime=0,this._submitCount=0,this._honeyValue=null,this._setupHoneypot(),this._devToolsOpen=!1,this._setupDevToolsDetection(),this._setupBehaviorTracking(),this._generateFingerprint()}recordTaskStart(e){const s=performance.now();if(this._lastTaskEndTime!==null){const i=s-this._lastTaskEndTime;i<Ze&&this._addViolation("rapid_task_switch",`Gap ${i.toFixed(0)}ms between tasks`,"critical")}this._taskStartTime=s,this._recordAction("task_start",{location:e})}recordTaskEnd(e,s){this._lastTaskEndTime=performance.now(),this._recordAction("task_end",{location:e,score:s})}validateAnswerSubmission(){if(this._suspended)return!1;if(this._honeypotTripped())return this._addViolation("honeypot","Hidden field was filled","critical"),!1;const e=Date.now();if(e-this._lastSubmitTime<400)return this._addViolation("rate_limit","Submission throttled","medium"),!1;if(this._lastSubmitTime=e,this._submitCount++,this._taskStartTime!==null){const s=performance.now()-this._taskStartTime;if(s<We)return this._addViolation("sub_500ms",`Answer in ${s.toFixed(0)}ms`,"critical"),!1;this._answerTimings.push(s),this._analyzeTimingDistribution()}return!this._hasUserInteracted&&this._actionLog.length>3&&this._addViolation("no_interaction","No user input detected","medium"),this._verifyChainIntegrity()?(this._recordAction("answer_submit",{submitCount:this._submitCount}),!0):(this._addViolation("chain_tamper","Action log integrity failure","critical"),!1)}buildSubmitPayload(e,s,i){const o=this._mouseEntropy(),n=this._answerTimings.length>0?this._answerTimings.reduce((u,f)=>u+f,0)/this._answerTimings.length:0,l=[this._sessionId,e,s,o.toFixed(2),Math.round(n),this._violations,i].join(":");return{token:this._hashString(l).toString(36)+"-"+this._sessionId,violations:this._violations,violationLog:this._violationLog.slice(-10),mouseEntropy:o.toFixed(2),avgAnswerMs:Math.round(n),fingerprint:this._fingerprint||"",sessionId:this._sessionId}}get violations(){return this._violations}get suspended(){return this._suspended}get sessionId(){return this._sessionId}_analyzeTimingDistribution(){if(this._answerTimings.length<Xe)return;const e=this._answerTimings.reduce((o,n)=>o+n,0)/this._answerTimings.length,s=this._answerTimings.reduce((o,n)=>o+(n-e)**2,0)/this._answerTimings.length,i=Math.sqrt(s);i<Je&&e<4e3&&this._addViolation("timing_consistency",`StdDev ${i.toFixed(0)}ms, mean ${e.toFixed(0)}ms`,"medium")}_mouseEntropy(){if(this._mouseMovements.length<10)return 1;const e=this._mouseMovements.map(o=>o.dt>0?Math.sqrt(o.dx**2+o.dy**2)/o.dt:0),s=e.reduce((o,n)=>o+n,0)/e.length,i=e.reduce((o,n)=>o+(n-s)**2,0)/e.length;return Math.sqrt(i)}_setupBehaviorTracking(){const e=(i,o,n)=>{this._mouseMovements.push({dx:i,dy:o,dt:n}),this._mouseMovements.length>200&&this._mouseMovements.shift(),this._hasUserInteracted=!0};let s=null;window.addEventListener("mousemove",i=>{s&&e(i.clientX-s.x,i.clientY-s.y,Date.now()-s.t),s={x:i.clientX,y:i.clientY,t:Date.now()}},{passive:!0}),window.addEventListener("touchstart",()=>{this._hasUserInteracted=!0},{passive:!0}),window.addEventListener("keydown",i=>{this._keyEvents.push(Date.now()),this._keyEvents.length>100&&this._keyEvents.shift(),this._hasUserInteracted=!0},{passive:!0})}_setupDevToolsDetection(){const s=()=>{const i=window.outerWidth-window.innerWidth>160||window.outerHeight-window.innerHeight>160;i&&!this._devToolsOpen?(this._devToolsOpen=!0,this._addViolation("devtools","DevTools window detected","low")):i||(this._devToolsOpen=!1)};setInterval(s,2e3),window.addEventListener("resize",s)}_setupHoneypot(){const e=document.createElement("input");e.type="text",e.name="email_confirm",e.autocomplete="off",e.tabIndex=-1,e.setAttribute("aria-hidden","true"),e.style.cssText="position:absolute;left:-9999px;width:1px;height:1px;opacity:0;",document.body.appendChild(e),this._honeypotEl=e}_honeypotTripped(){return this._honeypotEl&&this._honeypotEl.value.length>0}_recordAction(e,s){const i=JSON.stringify({type:e,data:s,t:Date.now()});this._chainHash=this._hashString(i+":"+this._chainHash.toString(36)),this._actionLog.push({type:e,t:Date.now(),h:this._chainHash}),this._actionLog.length>500&&this._actionLog.shift()}_verifyChainIntegrity(){for(let e=1;e<this._actionLog.length;e++)if(this._actionLog[e].t<this._actionLog[e-1].t)return!1;return!0}_addViolation(e,s,i){const o=Ve[i]||1;this._violations+=o,this._violationLog.push({code:e,detail:s,severity:i,t:Date.now()}),this._violations>=He&&!this._suspended&&(this._suspended=!0)}async _generateFingerprint(){try{const e=document.createElement("canvas");e.width=200,e.height=50;const s=e.getContext("2d");s.textBaseline="top",s.font="14px Poppins, Arial",s.fillStyle="#c0392b",s.fillRect(10,5,80,20),s.fillStyle="#2c3e50",s.fillText("Liepaja2026",5,8),s.fillStyle="rgba(44, 62, 80, 0.6)",s.fillText("Liepaja2026",7,10);const i=e.toDataURL(),o=[screen.width,screen.height,screen.colorDepth,new Date().getTimezoneOffset(),navigator.hardwareConcurrency||0].join(":");this._fingerprint=this._hashString(i+o).toString(36).substring(0,12)}catch{this._fingerprint="unavailable"}}_generateSessionId(){var s;const e=new Uint32Array(3);return(s=window.crypto)!=null&&s.getRandomValues?window.crypto.getRandomValues(e):(e[0]=Math.random()*4294967295>>>0,e[1]=Math.random()*4294967295>>>0,e[2]=Math.random()*4294967295>>>0),e[0].toString(36)+e[1].toString(36)+e[2].toString(36)}_hashString(e){let s=2166136261;for(let i=0;i<e.length;i++)s^=e.charCodeAt(i),s=Math.imul(s,16777619);return s>>>0}}const re=new Ye;(function(){const e=()=>{};try{Object.defineProperty(window,"console",{get:()=>({log:e,warn:e,error:e,info:e,debug:e,dir:e,table:e,trace:e}),set:e})}catch{}})();document.addEventListener("contextmenu",a=>{a.target.closest("[data-game]")&&a.preventDefault()});const Qe={RTU:[{id:"rtu_1",q:"Kurā gadā dibināta Liepājas akadēmija?",fact:"RTU Liepājas akadēmija dibināta 1954. gadā!"},{id:"rtu_2",q:"Kāda IT studiju programma ir pieejama RTU Liepājā?",fact:"Datorika ir viena no populārākajām programmām RTU Liepājā!"},{id:"rtu_3",q:"Kurā pilsētas daļā atrodas RTU Liepājas akadēmija?",fact:"RTU Liepājas akadēmija atrodas pašā pilsētas centrā!"}],Mols:[{id:"mols_1",q:"Cik metrus garš ir Ziemeļu mols?",fact:"Ziemeļu mols ir aptuveni 1800 metrus garš!"},{id:"mols_2",q:"Ko cilvēki dara uz Ziemeļu mola? (makšķerē/peld)",fact:"Mols ir populāra makšķerēšanas vieta!"},{id:"mols_3",q:"Kuras ostas daļā atrodas Ziemeļu mols? (ziemeļu/dienvidu)",fact:"Mols atrodas ostas ziemeļu pusē."}],Cietums:[{id:"cietums_1",q:"Kā sauc Karostas tūrisma cietumu?",fact:"Vienīgais militārais cietums atvērts tūristiem!"},{id:"cietums_2",q:"Kurā gadā celts Karostas cietums?",fact:"Cietums celts 1900. gadā cara armijas vajadzībām."},{id:"cietums_3",q:"Kam sākotnēji bija paredzēts Karostas cietums? (armija/civīliem)",fact:"Cietums bija paredzēts cara armijas vajadzībām."}],Dzintars:[{id:"dzintars_1",q:"Kā sauc Liepājas koncertzāli?",fact:"Izskatās pēc milzīga dzintara gabala!"},{id:"dzintars_2",q:'Kurā gadā atklāta koncertzāle "Lielais Dzintars"?',fact:"Koncertzāle atklāta 2015. gadā."},{id:"dzintars_3",q:"Kura orķestra mājvieta ir Lielais Dzintars? (Simfoniskā/Kamermūzikas)",fact:"Liepājas Simfoniskais orķestris šeit uzstājas regulāri!"}],Teatris:[{id:"teatris_1",q:"Kurā gadā dibināts Liepājas Teātris?",fact:"Vecākais profesionālais teātris Latvijā!"},{id:"teatris_2",q:"Kādā arhitektūras stilā celta Liepājas Teātra ēka?",fact:"Teātra ēka ir skaists jūgendstila piemērs!"},{id:"teatris_3",q:"Vai Liepājas Teātris ir vecākais profesionālais teātris Latvijā? (Ja/Ne)",fact:"Dibināts 1907. gadā — vecākais profesionālais teātris!"}],Kanals:[{id:"kanals_1",q:"Kā sauc kanālu starp ezeru un jūru?",fact:"Tirdzniecības kanāls savieno ezeru ar jūru."},{id:"kanals_2",q:"Kopš kura gadsimta kalpo Tirdzniecības kanāls?",fact:"Kanāls kalpo kopš 16. gadsimta!"},{id:"kanals_3",q:"Ko Tirdzniecības kanāls savieno? (ezeru un jūru/upes)",fact:"Kanāls savieno Liepājas ezeru ar Baltijas jūru."}],Osta:[{id:"osta_1",q:"Kā sauc Liepājas speciālo zonu?",fact:"Osta šeit neaizsalst!"},{id:"osta_2",q:"Vai Liepājas osta aizsalst ziemā? (Ja/Ne)",fact:"Liepājas osta neaizsalst — unikāla iezīme!"},{id:"osta_3",q:"Kā sauc ostas speciālo ekonomisko zonu? (LSEZ/LREZ)",fact:"Liepājas Speciālā ekonomiskā zona piesaista investorus."}],Parks:[{id:"parks_1",q:"Kā sauc parku pie jūras?",fact:"Viens no lielākajiem parkiem Latvijā!"},{id:"parks_2",q:"Kurā gadsimtā ierīkots Jūrmalas parks?",fact:"Parks ierīkots 19. gadsimta beigās."},{id:"parks_3",q:"Cik koku un krūmu sugu aug Jūrmalas parkā? (170/50/300)",fact:"Parkā aug vairāk nekā 170 koku un krūmu sugas!"}],LSEZ:[{id:"lsez_1",q:"Vai UPB ir Liepājas uzņēmums (Ja/Ne)?",fact:"UPB būvē ēkas visā pasaulē!"},{id:"lsez_2",q:"Kurā gadā izveidota LSEZ?",fact:"LSEZ izveidota 1997. gadā."},{id:"lsez_3",q:"Cik uzņēmumi darbojas LSEZ teritorijā? (80/20/200)",fact:"Vairāk nekā 80 uzņēmumi darbojas LSEZ!"}],Ezerkrasts:[{id:"ezerkrasts_1",q:"Kāda ezera krastā ir taka?",fact:"Liepājas ezers ir piektais lielākais Latvijā."},{id:"ezerkrasts_2",q:"Kurš lielākais ezers Latvijā ir Liepājas ezers? (5./3./7.)",fact:"Liepājas ezers ir piektais lielākais Latvijā!"},{id:"ezerkrasts_3",q:"Ko var vērot no Ezerkrasta takas skatu platformām? (putnus/zivis)",fact:"Taka piedāvā skatu platformas putnu vērošanai!"}]};function ce(a){const e=Qe[a];return e?e[Math.floor(Math.random()*e.length)]:null}const Ne=r.createContext(null),we={playerName:"Anonims",mode:"single",role:null,lobbyCode:null,startTime:null,score:0,completedTasks:0,currentLocation:null,selectedQuestions:{},notifications:[],connectionMode:"php",connectionStatus:"disconnected",gamePhase:"menu"};function et(a,e){switch(e.type){case"SET_PLAYER":return{...a,playerName:e.name};case"SET_MODE":return{...a,mode:e.mode,role:e.role||null,lobbyCode:e.lobbyCode||null};case"START_GAME":return{...a,gamePhase:"map",startTime:e.startTime,score:e.score||0,completedTasks:e.completedTasks||0,selectedQuestions:e.questions||{}};case"SET_LOCATION":return{...a,currentLocation:e.location};case"ADD_SCORE":return{...a,score:e.score};case"COMPLETE_TASK":return{...a,completedTasks:e.completedTasks};case"END_GAME":return{...a,gamePhase:"ended"};case"RESET_GAME":return{...we,playerName:a.playerName};case"SET_CONNECTION":return{...a,connectionMode:e.mode||a.connectionMode,connectionStatus:e.status||a.connectionStatus};case"ADD_NOTIFICATION":return{...a,notifications:[...a.notifications,{id:Date.now(),message:e.message,kind:e.kind,duration:e.duration||3e3}]};case"REMOVE_NOTIFICATION":return{...a,notifications:a.notifications.filter(s=>s.id!==e.id)};default:return a}}function tt({children:a}){const[e,s]=r.useReducer(et,we),i=r.useRef({});r.useEffect(()=>{const c={};Q.forEach(m=>{c[m]=ce(m)}),i.current=c},[]);const o=r.useCallback((c,m="info",d=3e3)=>{s({type:"ADD_NOTIFICATION",message:c,kind:m,duration:d})},[]),n=r.useCallback(c=>{s({type:"REMOVE_NOTIFICATION",id:c})},[]),l=r.useCallback(c=>{const m=q.addScore(c);return s({type:"ADD_SCORE",score:m}),m},[]),u=r.useCallback(()=>{const c=q.completeTask();return s({type:"COMPLETE_TASK",completedTasks:c}),c},[]),f=r.useCallback((c,m,d,v)=>{q.reset(),re._recordAction&&re._recordAction("game_start",{name:c,mode:m});const p={};Q.forEach(g=>{p[g]=ce(g)}),i.current=p;const k=Date.now();q.saveStartTime(k),s({type:"SET_PLAYER",name:c||"Anonims"}),s({type:"SET_MODE",mode:m||"single",role:d||null,lobbyCode:v||null}),s({type:"START_GAME",startTime:k,score:0,completedTasks:0,questions:p})},[]),_=r.useCallback((c,m,d,v)=>{const p=q.loadFromSession(),k=q.getStartTime(),g={};Q.forEach(C=>{g[C]=ce(C)}),i.current=g;const S=k||Date.now();return k||q.saveStartTime(S),s({type:"SET_PLAYER",name:c||"Anonims"}),s({type:"SET_MODE",mode:m||"single",role:d,lobbyCode:v}),s({type:"START_GAME",startTime:S,score:p?q.getScore():0,completedTasks:p?q.getCompleted():0,questions:g}),{completedTasks:p?q.getCompleted():0,score:p?q.getScore():0}},[]),b={state:e,dispatch:s,notify:o,dismissNotification:n,addScore:l,completeTask:u,startFreshGame:f,restoreSession:_,questionsRef:i,antiCheat:re,gameState:q,TOTAL_TASKS:te,taskSequence:Q};return t.jsx(Ne.Provider,{value:b,children:a})}function W(){const a=r.useContext(Ne);if(!a)throw new Error("useGame must be used inside GameProvider");return a}const Ce=r.createContext(null),le={default:{"--bg-primary":"#332222","--bg-secondary":"#2a1a1a","--bg-tertiary":"#1a1010","--accent-primary":"#ffaa00","--accent-secondary":"#ff8800","--border-color":"#553333","--text-primary":"#ffffff","--text-secondary":"#cccccc"},dark:{"--bg-primary":"#2d1b4e","--bg-secondary":"#1a0f30","--bg-tertiary":"#0f0820","--accent-primary":"#bb86fc","--accent-secondary":"#9c5cff","--border-color":"#5a3d8a","--text-primary":"#ffffff","--text-secondary":"#d0b8ff"},light:{"--bg-primary":"#4a0f0f","--bg-secondary":"#3a0a0a","--bg-tertiary":"#2a0505","--accent-primary":"#ff4444","--accent-secondary":"#cc2222","--border-color":"#8a3333","--text-primary":"#ffffff","--text-secondary":"#ffcccc"},blue:{"--bg-primary":"#1e3a5f","--bg-secondary":"#2c5f8d","--bg-tertiary":"#1a2f4a","--accent-primary":"#ffd700","--accent-secondary":"#ffed4e","--border-color":"#4a7ba7","--text-primary":"#ffffff","--text-secondary":"#d0e8ff"}},Le={default:"Noklusejuma",dark:"Violeta",light:"Tumsi sarkana",blue:"Zila"};function st({children:a}){const[e,s]=r.useState(()=>localStorage.getItem("theme")||"default"),[i,o]=r.useState(()=>localStorage.getItem("animationsEnabled")!=="0"),[n,l]=r.useState(()=>parseInt(localStorage.getItem("musicVolume")||"30",10)),[u,f]=r.useState(()=>parseInt(localStorage.getItem("sfxVolume")||"50",10));r.useEffect(()=>{const d=le[e]||le.default;Object.entries(d).forEach(([v,p])=>{document.documentElement.style.setProperty(v,p)}),document.body.setAttribute("data-theme",e)},[e]),r.useEffect(()=>{i?document.body.classList.remove("no-animations"):document.body.classList.add("no-animations")},[i]);function _(d){s(d),localStorage.setItem("theme",d)}function b(d){o(d),localStorage.setItem("animationsEnabled",d?"1":"0")}function c(d){l(d),localStorage.setItem("musicVolume",d)}function m(d){f(d),localStorage.setItem("sfxVolume",d)}return t.jsx(Ce.Provider,{value:{theme:e,setTheme:_,animationsEnabled:i,toggleAnimations:b,musicVolume:n,setMusicVolume:c,sfxVolume:u,setSfxVolume:m,themeKeys:Object.keys(le),THEME_LABELS:Le},children:a})}function it(){const a=r.useContext(Ce);if(!a)throw new Error("useTheme must be used inside ThemeProvider");return a}const ge=8080,at=2e3,be=5,ke=1e3;function nt(){const{dispatch:a,notify:e}=W(),s=r.useRef(null),i=r.useRef(0),o=r.useRef(null),n=r.useRef("php"),l=r.useCallback(c=>a({type:"SET_CONNECTION",status:c}),[a]),u=r.useCallback(c=>{switch(c.type){case"created":a({type:"SET_MODE",mode:"multi",role:"host",lobbyCode:c.code});break;case"guest_joined":a({type:"SET_MODE",mode:"multi",role:"host"});break;case"joined_lobby":a({type:"SET_MODE",mode:"multi",role:"guest",lobbyCode:c.code});break;case"start_game":a({type:"SET_MODE",mode:"multi",role:c.role});break;case"sync_complete":break;case"player_disconnected":e(c.msg,"warning");break;case"error":e(c.msg,"error");break}},[a,e]),f=r.useCallback(c=>s.current&&s.current.readyState===WebSocket.OPEN?(s.current.send(JSON.stringify(c)),!0):!1,[]),_=r.useCallback(()=>{if(s.current&&s.current.readyState<=1)return;const m=`${location.protocol==="https:"?"wss:":"ws:"}//${location.hostname}:${ge}`;try{s.current=new WebSocket(m),s.current.onopen=()=>{i.current=0,l("connected"),n.current="websocket",a({type:"SET_CONNECTION",mode:"websocket",status:"connected"})},s.current.onmessage=d=>{try{u(JSON.parse(d.data))}catch{}},s.current.onerror=()=>l("error"),s.current.onclose=()=>{if(l("disconnected"),i.current<be){const d=ke*2**i.current;i.current++,l("reconnecting"),o.current=setTimeout(_,d)}}}catch{l("error")}},[a,u,l]),b=r.useCallback(()=>new Promise(c=>{const m=setTimeout(()=>{s.current&&s.current.close(),c(!1)},at);try{const d=location.protocol==="https:"?"wss:":"ws:";s.current=new WebSocket(`${d}//${location.hostname}:${ge}`),s.current.onopen=()=>{clearTimeout(m),i.current=0,s.current.onmessage=v=>{try{u(JSON.parse(v.data))}catch{}},s.current.onclose=()=>{if(l("disconnected"),i.current<be){const v=ke*2**i.current;i.current++,l("reconnecting"),o.current=setTimeout(_,v)}},l("connected"),a({type:"SET_CONNECTION",mode:"websocket",status:"connected"}),c(!0)},s.current.onerror=()=>{clearTimeout(m),c(!1)}}catch{clearTimeout(m),c(!1)}}),[_,a,u,l]);return r.useEffect(()=>()=>{o.current&&clearTimeout(o.current)},[]),{wsRef:s,send:f,connect:_,tryConnect:b,modeRef:n}}const ot="_overlay_3pmtb_1",rt="_content_3pmtb_19",ct="_wide_3pmtb_35",de={overlay:ot,content:rt,wide:ct};function J({open:a,onClose:e,children:s,wide:i=!1}){return a?t.jsx("div",{className:de.overlay,onClick:e,children:t.jsx("div",{className:`${de.content} ${i?de.wide:""}`,onClick:o=>o.stopPropagation(),"data-game":!0,children:s})}):null}const lt="_title_8loy0_1",dt="_sectionTitle_8loy0_9",ut="_label_8loy0_19",ht="_slider_8loy0_26",mt="_themeGrid_8loy0_33",pt="_themeBtn_8loy0_40",_t="_active_8loy0_59",ft="_preview_8loy0_61",gt="_toggleLabel_8loy0_69",bt="_toggle_8loy0_69",kt="_slider2_8loy0_93",xt="_closeBtn_8loy0_117",M={title:lt,sectionTitle:dt,label:ut,slider:ht,themeGrid:mt,themeBtn:pt,active:_t,preview:ft,toggleLabel:gt,toggle:bt,slider2:kt,closeBtn:xt};function Ie({open:a,onClose:e}){const{theme:s,setTheme:i,animationsEnabled:o,toggleAnimations:n,musicVolume:l,setMusicVolume:u,sfxVolume:f,setSfxVolume:_,themeKeys:b}=it();return t.jsxs(J,{open:a,onClose:e,children:[t.jsx("h2",{className:M.title,children:"Iestatijumi"}),t.jsx("h3",{className:M.sectionTitle,children:"Audio"}),t.jsx("label",{className:M.label,children:"Muzika"}),t.jsx("input",{type:"range",min:"0",max:"100",value:l,onChange:c=>u(Number(c.target.value)),className:M.slider}),t.jsx("label",{className:M.label,children:"Skanas efekti"}),t.jsx("input",{type:"range",min:"0",max:"100",value:f,onChange:c=>_(Number(c.target.value)),className:M.slider}),t.jsx("h3",{className:M.sectionTitle,children:"Krasu tema"}),t.jsx("div",{className:M.themeGrid,children:b.map(c=>t.jsxs("button",{className:`${M.themeBtn} ${s===c?M.active:""}`,onClick:()=>i(c),children:[t.jsx("span",{className:M.preview,style:{background:"var(--bg-secondary)"}}),Le[c]||c]},c))}),t.jsx("h3",{className:M.sectionTitle,children:"Animacijas"}),t.jsxs("label",{className:M.toggleLabel,children:[t.jsx("span",{children:"Animacijas ieslēgtas"}),t.jsxs("div",{className:M.toggle,children:[t.jsx("input",{type:"checkbox",checked:o,onChange:c=>n(c.target.checked)}),t.jsx("span",{className:M.slider2})]})]}),t.jsx("button",{className:M.closeBtn,onClick:e,children:"Aizvērt"})]})}const St="_title_1kmy3_1",jt="_section_1kmy3_2",vt="_infoBox_1kmy3_3",Tt="_ruleList_1kmy3_7",yt="_legendList_1kmy3_9",Et="_dot_1kmy3_12",Nt="_green_1kmy3_13",wt="_blue_1kmy3_14",Ct="_yellow_1kmy3_15",Lt="_red_1kmy3_16",It="_twoCol_1kmy3_18",zt="_techList_1kmy3_21",At="_resources_1kmy3_23",Ot="_closeBtn_1kmy3_26",T={title:St,section:jt,infoBox:vt,ruleList:Tt,legendList:yt,dot:Et,green:Nt,blue:wt,yellow:Ct,red:Lt,twoCol:It,techList:zt,resources:At,closeBtn:Ot};function ze({open:a,onClose:e}){return t.jsxs(J,{open:a,onClose:e,children:[t.jsx("h2",{className:T.title,children:"Par Speli"}),t.jsxs("div",{className:T.infoBox,children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Spele:"})," Macibas ekskursija Liepaja"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Merkis:"})," Iepazit Liepajas kultuurvesturiskās vietas, uznemums un RTU akademiju, veicot interaktīvus uzdevumus."]})]}),t.jsx("h3",{className:T.section,children:"Speles noteikumi"}),t.jsx("div",{className:T.infoBox,children:t.jsxs("ol",{className:T.ruleList,children:[t.jsxs("li",{children:["Ekskursija ietver ",t.jsx("strong",{children:"10 apmeklejuma vietas"}),", kas japamekle noteikta seciba."]}),t.jsx("li",{children:"Katra vieta sanemsi informaciju un uzdevumu."}),t.jsxs("li",{children:["Pareiza atbilde pirma meginjuma: ",t.jsx("strong",{children:"+10 punkti"}),"."]}),t.jsxs("li",{children:["Pareiza atbilde pec 1 nepareizas: ",t.jsx("strong",{children:"+5 punkti"}),". Pec 2 — 0 punkti, atbilde tiek paradita."]}),t.jsx("li",{children:"Speles beigās tiek paradits tavs rezultats un laiks."}),t.jsx("li",{children:"Vari saglabat rezultatu Top 10 tabulā!"})]})}),t.jsx("h3",{className:T.section,children:"Objektu nozime karte"}),t.jsxs("ul",{className:T.legendList,children:[t.jsxs("li",{children:[t.jsx("span",{className:`${T.dot} ${T.green}`})," Zals: Daba un atputa"]}),t.jsxs("li",{children:[t.jsx("span",{className:`${T.dot} ${T.blue}`})," Zils: Kultura un vesture"]}),t.jsxs("li",{children:[t.jsx("span",{className:`${T.dot} ${T.yellow}`})," Dzeltens: RTU akademija"]}),t.jsxs("li",{children:[t.jsx("span",{className:`${T.dot} ${T.red}`})," Sarkans: Industrija un osta"]})]}),t.jsxs("div",{className:T.twoCol,children:[t.jsxs("div",{children:[t.jsx("h3",{className:T.section,children:"Tehnologijas"}),t.jsxs("ul",{className:T.techList,children:[t.jsx("li",{children:"React 18 + Vite 5"}),t.jsx("li",{children:"Phaser 3 (mini-speles)"}),t.jsx("li",{children:"PHP (aizmugure)"}),t.jsx("li",{children:"WebSocket (real-time)"}),t.jsx("li",{children:"AI: Gemini, Claude, Copilot"})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:T.section,children:"Izstraadataji (2PT)"}),t.jsxs("ul",{className:T.techList,children:[t.jsx("li",{children:"Niks Senvalds"}),t.jsx("li",{children:"Dans Bitenieks"})]})]})]}),t.jsx("h3",{className:T.section,children:"Izmantotie resursi"}),t.jsxs("div",{className:T.resources,children:[t.jsxs("p",{children:[t.jsx("strong",{children:"Atteli:"})," OpenStreetMap, Freepik"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Audio:"})," Brivās licences audio"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Informacija:"})," liepaja.lv, rtu.lv, wikipedia.org"]}),t.jsxs("p",{children:[t.jsx("strong",{children:"Bibliotēkas:"})," Bootstrap 5, Node.js, Phaser 3"]})]}),t.jsx("button",{className:T.closeBtn,onClick:e,children:"Aizvērt"})]})}const Mt="_container_bv0d0_1",Rt="_note_bv0d0_12",Pt="_slideIn_bv0d0_1",Dt="_success_bv0d0_33",Bt="_error_bv0d0_34",$t="_warning_bv0d0_35",Ft="_info_bv0d0_36",Gt="_icon_bv0d0_38",Kt="_text_bv0d0_46",ee={container:Mt,note:Rt,slideIn:Pt,success:Dt,error:Bt,warning:$t,info:Ft,icon:Gt,text:Kt};function qt({note:a}){const{dismissNotification:e}=W();return r.useEffect(()=>{const s=setTimeout(()=>e(a.id),a.duration);return()=>clearTimeout(s)},[a.id,a.duration,e]),t.jsxs("div",{className:`${ee.note} ${ee[a.kind]||""}`,children:[t.jsxs("span",{className:ee.icon,children:[a.kind==="success"&&"+",a.kind==="error"&&"!",a.kind==="warning"&&"!",a.kind==="info"&&"i"]}),t.jsx("span",{className:ee.text,children:a.message})]})}function Ae(){const{state:a}=W();return a.notifications.length===0?null:t.jsx("div",{className:ee.container,children:a.notifications.map(e=>t.jsx(qt,{note:e},e.id))})}const Ut="_root_1kro3_1",Vt="_bgCanvas_1kro3_12",Ht="_center_1kro3_19",Wt="_title_1kro3_32",Zt="_subtitle_1kro3_56",Jt="_menu_1kro3_72",Xt="_modePanel_1kro3_72",Yt="_inputWrapper_1kro3_79",Qt="_inputLabel_1kro3_81",es="_input_1kro3_79",ts="_btn_1kro3_110",ss="_btnSecondary_1kro3_140",is="_divider_1kro3_156",as="_lobby_1kro3_163",ns="_lobbyLabel_1kro3_170",os="_codeBox_1kro3_171",rs="_lobbyStatus_1kro3_182",cs="_authors_1kro3_190",x={root:Ut,bgCanvas:Vt,center:Ht,title:Wt,subtitle:Zt,menu:Jt,modePanel:Xt,inputWrapper:Yt,inputLabel:Qt,input:es,btn:ts,btnSecondary:ss,divider:is,lobby:as,lobbyLabel:ns,codeBox:os,lobbyStatus:rs,authors:cs};function xe(){const{startFreshGame:a,notify:e,dispatch:s}=W(),i=Te(),{tryConnect:o,wsRef:n,modeRef:l}=nt(),[u,f]=r.useState(""),[_,b]=r.useState(!1),[c,m]=r.useState(!1),[d,v]=r.useState(""),[p,k]=r.useState(null),[g,S]=r.useState(""),[C,$]=r.useState(!1),[F,E]=r.useState(!1),I=r.useRef(null),N=r.useRef(null),y=r.useRef([]);r.useEffect(()=>((location.hostname==="localhost"||location.hostname==="127.0.0.1")&&o().then(h=>{h&&s({type:"SET_CONNECTION",mode:"websocket",status:"connected"})}),Y(),()=>{N.current&&cancelAnimationFrame(N.current)}),[]),r.useEffect(()=>{const h=n.current;h&&(h.onmessage=G=>{try{const w=JSON.parse(G.data);if(w.type==="created")k(w.code),S("Gaidu otru speletaju...");else if(w.type==="guest_joined")S("Speletajs pievienojās! Sagatavojies...");else if(w.type==="player_ready")S("Otrs speletajs ir gatavy!");else if(w.type==="start_game"){const se=w.role;a(u,"multi",se,p),i("/play")}else w.type==="error"&&e(w.msg,"error")}catch{}})},[n.current,p,u]);function B(){const h=u.trim().substring(0,8);return h||(e("Ievadi savu vardu!","warning"),null)}function K(){const h=B();h&&(a(h,"single",null,null),i("/play"))}function A(){var G;B()&&(l.current==="websocket"&&((G=n.current)==null?void 0:G.readyState)===1?(n.current.send(JSON.stringify({action:"create"})),S("Verdu istabu...")):fetch(`../src/php/lobby.php?action=create&code=${Math.floor(1e3+Math.random()*9e3)}`).then(w=>w.json()).then(w=>{w.status==="success"&&(k(w.code),S("Gaidu otru speletaju..."))}))}function X(){var G;const h=B();if(h){if(!d||d.length!==4){e("Ievadi 4-ciparu kodu!","error");return}l.current==="websocket"&&((G=n.current)==null?void 0:G.readyState)===1?n.current.send(JSON.stringify({action:"join",code:d})):fetch(`../src/php/lobby.php?action=join&code=${d}`).then(w=>w.json()).then(w=>{w.status==="success"?(a(h,"multi","guest",d),i("/play")):e("Istaba nav atrasta vai jau pilna.","error")})}}function H(){var h;((h=n.current)==null?void 0:h.readyState)===1&&(n.current.send(JSON.stringify({action:"ready",code:p,role:"host"})),S("Gaidu otru speletaju sagatavoties..."))}function Y(){const h=I.current;if(!h)return;h.width=window.innerWidth,h.height=window.innerHeight;const G=h.getContext("2d"),w=120;y.current=Array.from({length:w},()=>({x:Math.random()*h.width,y:Math.random()*h.height,r:Math.random()*1.8+.4,dx:(Math.random()-.5)*.35,dy:(Math.random()-.5)*.35,alpha:Math.random()*.5+.1}));const se=()=>{G.clearRect(0,0,h.width,h.height),y.current.forEach(O=>{G.beginPath(),G.arc(O.x,O.y,O.r,0,Math.PI*2),G.fillStyle=`rgba(255,170,0,${O.alpha})`,G.fill(),O.x+=O.dx,O.y+=O.dy,O.x<0&&(O.x=h.width),O.x>h.width&&(O.x=0),O.y<0&&(O.y=h.height),O.y>h.height&&(O.y=0)}),N.current=requestAnimationFrame(se)};se();const _e=()=>{h.width=window.innerWidth,h.height=window.innerHeight};return window.addEventListener("resize",_e),()=>window.removeEventListener("resize",_e)}return t.jsxs("div",{className:x.root,children:[t.jsx("canvas",{ref:I,className:x.bgCanvas}),t.jsxs("div",{className:x.center,children:[t.jsx("h1",{className:x.title,children:"LIEPAJAS KARTE"}),t.jsx("h2",{className:x.subtitle,children:"EKSKURSIJA"}),!_&&!p?t.jsxs("div",{className:x.menu,children:[t.jsxs("div",{className:x.inputWrapper,children:[t.jsx("label",{className:x.inputLabel,children:"Tavs vards"}),t.jsx("input",{className:x.input,type:"text",placeholder:"Ievadi savu vardu...",maxLength:8,value:u,onChange:h=>f(h.target.value),onKeyDown:h=>{h.key==="Enter"&&K()}})]}),t.jsx("button",{className:x.btn,onClick:K,children:"Spelet vienam"}),t.jsx("button",{className:x.btn,onClick:()=>b(!0),children:"Spelet ar draugu"}),t.jsx("button",{className:x.btn,onClick:()=>i("/leaderboard"),children:"Top 10"}),t.jsx("button",{className:x.btn,onClick:()=>$(!0),children:"Iestatijumi"}),t.jsx("button",{className:x.btn,onClick:()=>E(!0),children:"Par speli"}),t.jsx("button",{className:x.btn,onClick:()=>window.location.href="https://www.google.com",children:"Iziet"})]}):p?t.jsxs("div",{className:x.lobby,children:[t.jsx("p",{className:x.lobbyLabel,children:"Tavas istabas kods:"}),t.jsx("div",{className:x.codeBox,children:p}),t.jsx("p",{className:x.lobbyStatus,children:g}),g.includes("pievienojās")&&t.jsx("button",{className:x.btn,onClick:H,children:"Esmu gatavy!"}),t.jsx("button",{className:x.btnSecondary,onClick:()=>{k(null),b(!1)},children:"Atcelt"})]}):t.jsxs("div",{className:x.modePanel,children:[t.jsxs("div",{className:x.inputWrapper,children:[t.jsx("label",{className:x.inputLabel,children:"Tavs vards"}),t.jsx("input",{className:x.input,type:"text",placeholder:"Ievadi savu vardu...",maxLength:8,value:u,onChange:h=>f(h.target.value)})]}),t.jsx("button",{className:x.btn,onClick:A,children:"Izveidot istabu"}),t.jsx("div",{className:x.divider}),t.jsxs("div",{className:x.inputWrapper,children:[t.jsx("label",{className:x.inputLabel,children:"Drauga kods"}),t.jsx("input",{className:x.input,type:"text",placeholder:"Ievadi 4-ciparu kodu",maxLength:4,value:d,onChange:h=>v(h.target.value),onKeyDown:h=>{h.key==="Enter"&&X()}})]}),t.jsx("button",{className:x.btn,onClick:X,children:"Pievienoties"}),t.jsx("button",{className:x.btnSecondary,onClick:()=>b(!1),children:"Atcelt"})]})]}),t.jsx("div",{className:x.authors,children:"Autori: Niks Senvalds, Dans Bitenieks"}),t.jsx(Ie,{open:C,onClose:()=>$(!1)}),t.jsx(ze,{open:F,onClose:()=>E(!1)}),t.jsx(Ae,{})]})}const Oe={RTU:{name:"RTU Liepājas akadēmija",desc:'Rīgas Tehniskās universitātes Liepājas akadēmija (dibināta 1954. gadā) ir viena no nozīmīgākajām augstākās izglītības iestādēm Kurzemē. Tā piedāvā studiju programmas inženierzinātnēs, IT (Datorika), ekonomikā un humanitārajās zinātnēs. Studiju programma "Datorika" ietver programmēšanu, datoru tīklus, datu bāzes un mākslīgo intelektu.'},Dzintars:{name:'Koncertzāle "Lielais Dzintars"',desc:'Liepājas koncertzāle "Lielais Dzintars" ir moderna daudzfunkcionāla koncertzāle, kas atklāta 2015. gadā. Ēkas unikālais dizains atgādina milzīgu dzintara gabalu. Šeit regulāri notiek Liepājas Simfoniskā orķestra koncerti, starptautiski festivāli un kultūras pasākumi.'},Teatris:{name:"Liepājas Teātris",desc:"Liepājas Teātris, dibināts 1907. gadā, ir vecākais profesionālais teātris Latvijā. Teātris atrodas skaistā jūgendstila ēkā Liepājas centrā. Tas ir nozīmīgs kultūras centrs, kurā tiek iestudētas gan klasiskās, gan mūsdienu lugas."},Kanals:{name:"Tirdzniecības kanāls",desc:"Tirdzniecības kanāls savieno Liepājas ezeru ar Baltijas jūru. Tas ir vēsturiski nozīmīgs ūdensceļš, kas jau kopš 16. gadsimta kalpojis tirdzniecības vajadzībām. Gar kanāla krastiem ir populāra pastaigu vieta ar skaistiem skatiem."},Osta:{name:"Liepājas Osta",desc:"Liepājas osta ir viena no lielākajām un nozīmīgākajām Latvijas ostām. Tā ir unikāla, jo neaizsalst ziemā, pateicoties īpašiem strāvojumu apstākļiem. Ostā darbojas Liepājas Speciālā ekonomiskā zona (LSEZ), kas piesaista starptautiskus uzņēmumus."},LSEZ:{name:"Liepājas Speciālā ekonomiskā zona (LSEZ)",desc:"LSEZ ir izveidota 1997. gadā, lai veicinātu Liepājas reģiona ekonomisko attīstību. Zonā darbojas vairāk nekā 80 uzņēmumi, tostarp UPB — starptautisks būvniecības uzņēmums, kas realizē projektus visā pasaulē. LSEZ piedāvā nodokļu atvieglojumus investoriem."},Cietums:{name:"Karostas cietums",desc:"Karostas cietums ir unikāla tūrisma vieta — vienīgais bijušais militārais cietums Eiropā, kas atvērts apmeklētājiem. Cietums celts 1900. gadā cara armijas vajadzībām. Šobrīd tas piedāvā ekskursijas un nakšņošanas pieredzi autentiskā cietuma vidē."},Mols:{name:"Ziemeļu mols",desc:"Ziemeļu mols ir aptuveni 1800 metrus garš akmeņu mols Liepājas ostas ziemeļu daļā. Tas ir populāra pastaigu un makšķerēšanas vieta. No mola paveras brīnišķīgs skats uz Baltijas jūru un Liepājas piekrasti."},Ezerkrasts:{name:"Ezerkrasta taka",desc:"Ezerkrasta taka atrodas pie Liepājas ezera — piektā lielākā ezera Latvijā. Taka piedāvā skaistu pastaigu maršrutu gar ezera krastu ar skatu platformām un informatīviem stendiem par apkārtnes dabu un putniem."},Parks:{name:"Jūrmalas parks",desc:"Jūrmalas parks ir viens no lielākajiem un vecākajiem parkiem Latvijā, ierīkots 19. gadsimta beigās. Parks atrodas starp pilsētas centru un jūras piekrasti. Tajā aug vairāk nekā 170 koku un krūmu sugas, un parks ir iecienīta atpūtas vieta."}},ls="_layout_160i5_1",ds="_guideCol_160i5_7",us="_guideImg_160i5_14",hs="_bubble_160i5_19",ms="_taskCol_160i5_31",ps="_locTitle_160i5_38",_s="_locName_160i5_44",fs="_questionText_160i5_50",gs="_hint_160i5_57",bs="_desc_160i5_63",ks="_input_160i5_73",xs="_btn_160i5_95",Ss="_helpBtn_160i5_115",js="_correct_160i5_130",vs="_wrong_160i5_137",Ts="_fact_160i5_143",L={layout:ls,guideCol:ds,guideImg:us,bubble:hs,taskCol:ms,locTitle:ps,locName:_s,questionText:fs,hint:gs,desc:bs,input:ks,btn:xs,helpBtn:Ss,correct:js,wrong:vs,fact:Ts},ys=["Lielisks darbs! Tu zini Liepajas vesturi!","Pareizi! Tu esi istenais eksperts!","Bravo! Ta turpini!","Izcili! Nakamais izaicinajums gaida!"],Es=["Ta nav pareiza atbilde. Megini velreiz!","Nekas, ari kludities ir cilveciski!","Gandrīz! Bet nepadodies!","Ups! Nakamreiz noteikti sanaks!"];function Se(a){const e=a?ys:Es;return e[Math.floor(Math.random()*e.length)]}function Ns({open:a,location:e,onComplete:s,onClose:i}){const{questionsRef:o,addScore:n,antiCheat:l,notify:u}=W(),[f,_]=r.useState("question"),[b,c]=r.useState(""),[m,d]=r.useState(0),[v,p]=r.useState("Sveiks! Esmu tavs gids."),[k,g]=r.useState(""),[S,C]=r.useState(0),[$,F]=r.useState(!1),E=r.useRef(null),I=e?o.current[e]:null,N=e?Oe[e]:null;r.useEffect(()=>{a&&(_("question"),c(""),d(0),p("Sveiks! Esmu tavs gids."),g(""),C(0),F(!1),l.recordTaskStart(e),setTimeout(()=>{var A;return(A=E.current)==null?void 0:A.focus()},80))},[a,e]);const y=r.useCallback(async()=>{if(!l.validateAnswerSubmission()){u("Atbilde iesniegta parsāk atri!","warning");return}if(!b.trim()){u("Ievadi atbildi!","warning");return}if(l.suspended){u("Sesija apturēta.","error");return}F(!0);try{const X=await(await fetch("../src/php/check_answer.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({questionId:I==null?void 0:I.id,answer:b.trim(),sessionId:l.sessionId,final:m>=1})})).json();if(X.correct){const H=m===0?10:5,Y=n(H);p(Se(!0)),C(H),g(`Pareizi! +${H} punkti`),_("result"),u(`Pareiza atbilde! +${H} punkti`,"success",2e3)}else{const H=m+1;d(H),p(Se(!1)),H>=2?(g(`Nepareizi. Pareizā atbilde: ${X.correctAnswer||"—"}`),_("result"),C(0),u("2 nepareizas atbildes. 0 punkti.","error",3e3)):(c(""),u("Nepareiza atbilde! Vel 1 meginjums.","error",2e3),l.recordTaskStart(e),setTimeout(()=>{var Y;return(Y=E.current)==null?void 0:Y.focus()},80))}}catch{u("Savienojuma kludda. Parbaudiet internetu.","error")}finally{F(!1)}},[b,m,I,e,n,l,u]),B=A=>{A.key==="Enter"&&(A.preventDefault(),y())},K=()=>{l.recordTaskEnd(e,S),s(S)};return!a||!e||!I?null:t.jsx(J,{open:a,onClose:f==="result"?i:void 0,children:t.jsxs("div",{className:L.layout,"data-game":!0,children:[t.jsxs("div",{className:L.guideCol,children:[t.jsx("img",{src:"/atteli/kaija.png",alt:"Gids",className:L.guideImg}),t.jsx("div",{className:L.bubble,children:v})]}),t.jsx("div",{className:L.taskCol,children:f==="theory"?t.jsxs(t.Fragment,{children:[t.jsx("h3",{className:L.locName,children:N==null?void 0:N.name}),t.jsx("p",{className:L.desc,children:N==null?void 0:N.desc}),t.jsx("button",{className:L.btn,onClick:()=>{_("question"),l.recordTaskStart(e),setTimeout(()=>{var A;return(A=E.current)==null?void 0:A.focus()},80)},children:"Atpakal uz jautajumu"})]}):f==="question"?t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:L.locTitle,children:e}),t.jsx("p",{className:L.questionText,children:I.q}),m===1&&t.jsx("p",{className:L.hint,children:"(Pareiza atbilde tagad dos +5 punktus)"}),t.jsx("input",{ref:E,className:L.input,type:"text",placeholder:"Tava atbilde...",maxLength:60,value:b,onChange:A=>c(A.target.value),onKeyDown:B,disabled:$,autoComplete:"off"}),t.jsx("button",{className:L.btn,onClick:y,disabled:$,children:$?"Parbauda...":m===1?"Iesniegt atkartoti":"Iesniegt"}),t.jsx("button",{className:L.helpBtn,onClick:()=>_("theory"),children:"? Palidziba"})]}):t.jsxs(t.Fragment,{children:[t.jsx("h2",{className:L.locTitle,children:e}),t.jsx("p",{className:S>0?L.correct:L.wrong,children:k}),t.jsx("p",{className:L.fact,children:I.fact}),t.jsx("button",{className:L.btn,onClick:K,children:"Turpinat"})]})})]})})}const ue=5,he=15,ws=44,Cs=28;class Ls extends D.Scene{constructor(){super({key:"AntScene"})}init(e){this.onComplete=e.onComplete||(()=>{}),this.onFail=e.onFail||(()=>{}),this.isMobile=navigator.maxTouchPoints>0||"ontouchstart"in window}create(){const{width:e,height:s}=this.scale;this.antsCaught=0,this.timeLeft=he,this.gameActive=!0,this.add.rectangle(0,0,e,s,670218,.5).setOrigin(0,0);const i=this.add.graphics();i.lineStyle(2,5025616,1),i.strokeRect(2,2,e-4,s-4),this.timerText=this.add.text(e/2,20,`Laiks: ${he}s`,{fontFamily:"Poppins, Arial",fontSize:"18px",color:"#ffaa00"}).setOrigin(.5,0),this.countText=this.add.text(e/2,48,`Nokerti: 0/${ue}`,{fontFamily:"Poppins, Arial",fontSize:"16px",color:"#ffffff"}).setOrigin(.5,0),this.timerEvent=this.time.addEvent({delay:1e3,repeat:he-1,callback:()=>{this.timeLeft--,this.timerText&&this.timerText.setText(`Laiks: ${this.timeLeft}s`),this.timeLeft<=0&&this.gameActive&&this.endGame(!1)}}),this.spawnAnt()}spawnAnt(){if(!this.gameActive)return;const{width:e,height:s}=this.scale,i=this.isMobile?ws:Cs,o=this.isMobile?16:6,n=i+o+10,l=D.Math.Between(n,e-n),u=D.Math.Between(n+60,s-n),f=this.add.text(l,u,"X",{fontFamily:"Poppins, monospace",fontSize:`${i}px`,color:"#c0392b",fontStyle:"bold"}).setOrigin(.5).setInteractive(new D.Geom.Circle(0,0,i/2+o),D.Geom.Circle.Contains);if(f.on("pointerdown",()=>{this.gameActive&&(this.antsCaught++,this.countText.setText(`Nokerti: ${this.antsCaught}/${ue}`),this.tweens.add({targets:f,alpha:0,scaleX:2,scaleY:2,duration:180,onComplete:()=>f.destroy()}),this.antsCaught>=ue?this.endGame(!0):this.time.delayedCall(300,()=>this.spawnAnt()))}),this.antsCaught>2&&this.gameActive){const _=this.isMobile?1600:900;this.time.addEvent({delay:_,loop:!0,callback:()=>{if(!f.active||!this.gameActive)return;const b=D.Math.Between(n,e-n),c=D.Math.Between(n+60,s-n);this.tweens.add({targets:f,x:b,y:c,duration:300})}})}}endGame(e){this.gameActive&&(this.gameActive=!1,this.timerEvent&&this.timerEvent.remove(),e?this.onComplete(10):this.onFail())}}const U={REQUIRED_PRESSES:10,EXCELLENT_TIME:3,GOOD_TIME:5,SLOW_TIME:10,EXCELLENT_POINTS:15,GOOD_POINTS:12,NORMAL_POINTS:10,SLOW_POINTS:5};class Is extends D.Scene{constructor(){super({key:"BoatScene"})}init(e){this.onComplete=e.onComplete||(()=>{})}create(){const{width:e,height:s}=this.scale;this.pressCount=0,this.raceActive=!1,this.startTime=0,this.isMobile=navigator.maxTouchPoints>0||"ontouchstart"in window;const i=this.add.graphics();i.fillGradientStyle(1989258,1989258,933214,933214,1),i.fillRect(0,0,e,s),this.add.text(e/2,20,"Ostas Regate",{fontFamily:"Poppins, Arial",fontSize:"22px",color:"#ffaa00",fontStyle:"bold"}).setOrigin(.5,0);const o=this.isMobile?`Spied pogu ${U.REQUIRED_PRESSES} reizes pec iespeja atraki!`:`Spied SPACE ${U.REQUIRED_PRESSES} reizes pec iespeja atraki!`;this.instructionText=this.add.text(e/2,55,o,{fontFamily:"Poppins, Arial",fontSize:"13px",color:"#cccccc",wordWrap:{width:e-40},align:"center"}).setOrigin(.5,0),this.timerText=this.add.text(e/2,s/2-40,"0.00 s",{fontFamily:"Poppins, Arial",fontSize:"36px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5),this.progressText=this.add.text(e/2,s/2+10,`Spiedienu skaits: 0/${U.REQUIRED_PRESSES}`,{fontFamily:"Poppins, Arial",fontSize:"16px",color:"#cccccc"}).setOrigin(.5);const n=this.add.rectangle(e/2,s-60,200,50,3351074).setInteractive({useHandCursor:!0});n.setStrokeStyle(2,16755200),this.btnText=this.add.text(e/2,s-60,"SAKT",{fontFamily:"Poppins, Arial",fontSize:"18px",color:"#ffaa00",fontStyle:"bold"}).setOrigin(.5),n.on("pointerdown",()=>this.handlePress()),n.on("pointerover",()=>n.setFillColor(4862771)),n.on("pointerout",()=>n.setFillColor(3351074)),this.btnBg=n,this.input.keyboard.on("keydown-SPACE",()=>this.handlePress())}handlePress(){if(!this.raceActive){this.startRace();return}this.pressCount++,this.progressText.setText(`Spiedienu skaits: ${this.pressCount}/${U.REQUIRED_PRESSES}`),this.tweens.add({targets:this.btnBg,scaleX:.92,scaleY:.92,duration:60,yoyo:!0}),this.pressCount>=U.REQUIRED_PRESSES&&this.finishRace()}startRace(){this.raceActive=!0,this.pressCount=0,this.startTime=this.time.now,this.btnText.setText("SPIED!"),this.timerUpdater=this.time.addEvent({delay:50,loop:!0,callback:()=>{if(!this.raceActive)return;const e=((this.time.now-this.startTime)/1e3).toFixed(2);this.timerText&&this.timerText.setText(`${e} s`)}})}finishRace(){this.raceActive=!1,this.timerUpdater&&this.timerUpdater.remove();const e=((this.time.now-this.startTime)/1e3).toFixed(2);let s=U.NORMAL_POINTS;e<U.EXCELLENT_TIME?s=U.EXCELLENT_POINTS:e<U.GOOD_TIME?s=U.GOOD_POINTS:e>U.SLOW_TIME&&(s=U.SLOW_POINTS),this.onComplete(s,parseFloat(e))}}const R={TENSION_INCREASE:.6,TENSION_DECREASE:.4,START_DISTANCE:15,PROGRESS_DECAY:.005,DEADLINE_THRESHOLD:80,FAIL_TIME_MAX:1.5,FISH_PULL_CHANCE:.015,FISH_PULL_STRENGTH:.5,EXCELLENT_TIME:10,GOOD_TIME:20,EXCELLENT_POINTS:15,GOOD_POINTS:10,NORMAL_POINTS:5};class zs extends D.Scene{constructor(){super({key:"FishingScene"})}init(e){this.onComplete=e.onComplete||(()=>{}),this.onFail=e.onFail||(()=>{})}create(){const{width:e,height:s}=this.scale;this.holding=!1,this.tension=0,this.distance=R.START_DISTANCE,this.failTimer=0,this.fishPullTimer=0,this.waveOffset=0,this.active_=!0,this.startTime=this.time.now,this.isMobile=navigator.maxTouchPoints>0||"ontouchstart"in window;const i=this.add.graphics();i.fillGradientStyle(6273248,6273248,3837887,3837887,1),i.fillRect(0,0,e,s*.5);const o=this.add.graphics();o.fillGradientStyle(3837887,3837887,933214,933214,1),o.fillRect(0,s*.5,e,s*.5),this.fishCanvas=this.add.graphics();const n=Math.min(200,e*.5);this.tensionBarBg=this.add.rectangle(e/2,28,n+4,22,0,.5).setOrigin(.5),this.tensionBar=this.add.rectangle(e/2-n/2,28,0,18,4521796).setOrigin(0,.5),this.tensionBarWidth=n,this.tensionBarX=e/2-n/2,this.tensionLabel=this.add.text(e/2,44,"Spriegums",{fontFamily:"Poppins, Arial",fontSize:"11px",color:"rgba(255,255,255,0.8)"}).setOrigin(.5,0),this.warningText=this.add.text(e/2,58,"",{fontFamily:"Poppins, Arial",fontSize:"14px",color:"#ff3232",fontStyle:"bold"}).setOrigin(.5,0),this.distanceText=this.add.text(e/2,s-30,`${R.START_DISTANCE.toFixed(2)} m`,{fontFamily:"Poppins, Arial",fontSize:"18px",color:"#ffffff",fontStyle:"bold"}).setOrigin(.5,1),this.distLabel=this.add.text(e/2,s-14,"Attālums lidz zivij",{fontFamily:"Poppins, Arial",fontSize:"11px",color:"rgba(255,255,255,0.5)"}).setOrigin(.5,1);const l=this.isMobile?70:60;this.holdBtn=this.add.circle(e-l/2-15,s-l/2-15,l/2,16766720).setInteractive({useHandCursor:!0,draggable:!1}),this.holdBtnLabel=this.add.text(e-l/2-15,s-l/2-15,this.isMobile?"TURI":"SPACE",{fontFamily:"Poppins, Arial",fontSize:"13px",color:"#333333",fontStyle:"bold"}).setOrigin(.5),this.holdBtn.on("pointerdown",()=>{this.holding=!0}),this.holdBtn.on("pointerup",()=>{this.holding=!1}),this.holdBtn.on("pointerout",()=>{this.holding=!1}),this.input.keyboard.on("keydown-SPACE",()=>{this.holding=!0}),this.input.keyboard.on("keyup-SPACE",()=>{this.holding=!1}),this.time.addEvent({delay:16,loop:!0,callback:this.gameLoop,callbackScope:this})}gameLoop(){if(!this.active_)return;const{width:e,height:s}=this.scale;Math.random()<R.FISH_PULL_CHANCE&&(this.fishPullTimer=15);const i=this.fishPullTimer>0;if(this.fishPullTimer>0&&this.fishPullTimer--,this.holding?(this.tension+=R.TENSION_INCREASE+(i?R.FISH_PULL_STRENGTH:0),this.distance-=.05):(this.tension-=R.TENSION_DECREASE,this.distance+=R.PROGRESS_DECAY+(i?.02:0)),this.tension=D.Math.Clamp(this.tension,0,100),this.distance=D.Math.Clamp(this.distance,0,R.START_DISTANCE),this.tension>=R.DEADLINE_THRESHOLD){if(this.failTimer+=.016,this.failTimer>=R.FAIL_TIME_MAX||this.tension>=100){this.endGame(!1);return}}else this.failTimer=Math.max(0,this.failTimer-.01);if(this.distance<=0){this.endGame(!0);return}this.waveOffset+=.03;const o=this.tension/100,n=Math.min(255,Math.round(o*510)),l=Math.min(255,Math.round((1-o)*510));this.tensionBar.width=this.tension/100*this.tensionBarWidth,this.tensionBar.fillColor=D.Display.Color.GetColor(n,l,50),this.tensionBar.x=this.tensionBarX,this.warningText.setText(this.tension>R.DEADLINE_THRESHOLD?"UZMANIETIES!":""),this.distanceText.setText(`${this.distance.toFixed(2)} m`),this.holdBtn&&(this.holdBtn.fillColor=i?16750848:16766720)}endGame(e){if(!this.active_)return;this.active_=!1;const s=(this.time.now-this.startTime)/1e3;if(e){let i=R.NORMAL_POINTS;s<R.EXCELLENT_TIME?i=R.EXCELLENT_POINTS:s<R.GOOD_TIME&&(i=R.GOOD_POINTS),this.onComplete(i,s.toFixed(1))}else this.onFail()}}const As="_canvas_1bj82_1",Os="_infoName_1bj82_9",Ms="_infoDesc_1bj82_15",Rs="_btn_1bj82_26",Ps="_closeBtn_1bj82_47",Ds="_retry_1bj82_64",Bs="_success_1bj82_68",$s="_failText_1bj82_76",V={canvas:As,infoName:Os,infoDesc:Ms,btn:Rs,closeBtn:Ps,retry:Ds,success:Bs,failText:$s},Fs={RTU:Ls,Osta:Is,Mols:zs};function Gs({open:a,location:e,onComplete:s,onClose:i}){const{addScore:o,antiCheat:n,notify:l}=W(),u=r.useRef(null),f=r.useRef(null),[_,b]=r.useState("info"),[c,m]=r.useState(""),[d,v]=r.useState(0),[p,k]=r.useState(!1),g=e?Oe[e]:null,S=e?Fs[e]:null,C=()=>{f.current&&(f.current.destroy(!0),f.current=null)},$=()=>{C(),b("playing"),k(!1),n.recordTaskStart(e),setTimeout(()=>{if(!u.current||!S)return;const E=new S;E.init({onComplete:(I,N)=>{C(),o(I),v(I),m(Ks(e,I,N)),b("result"),l(`+${I} punkti!`,"success",2e3)},onFail:()=>{C(),m(qs(e)),b("retry")}}),f.current=new D.Game({type:D.AUTO,parent:u.current,width:"100%",height:320,backgroundColor:"#000000",scene:E,scale:{mode:D.Scale.FIT,autoCenter:D.Scale.CENTER_BOTH},audio:{disableWebAudio:!0}})},80)};r.useEffect(()=>{a||(C(),b("info"))},[a]),r.useEffect(()=>()=>C(),[]);const F=()=>{n.recordTaskEnd(e,d),s(d)};return!a||!e||!S?null:t.jsx(J,{open:a,wide:!0,children:t.jsxs("div",{"data-game":!0,children:[_==="info"&&t.jsxs(t.Fragment,{children:[t.jsx("h3",{className:V.infoName,children:g==null?void 0:g.name}),t.jsx("p",{className:V.infoDesc,children:g==null?void 0:g.desc}),t.jsx("button",{className:V.btn,onClick:$,children:"Sakt uzdevumu"}),t.jsx("button",{className:V.closeBtn,onClick:i,children:"Atcelt"})]}),(_==="playing"||_==="retry")&&t.jsxs(t.Fragment,{children:[t.jsx("div",{ref:u,className:V.canvas}),_==="retry"&&t.jsxs("div",{className:V.retry,children:[t.jsx("p",{className:V.failText,children:c}),t.jsx("button",{className:V.btn,onClick:$,children:"Meginat velreiz"})]})]}),_==="result"&&t.jsxs(t.Fragment,{children:[t.jsx("p",{className:V.success,children:c}),t.jsx("button",{className:V.btn,onClick:F,children:"Turpinat"})]})]})})}function Ks(a,e,s){switch(a){case"RTU":return`Visi kukaiņi nokerti! +${e} punkti`;case"Osta":return`Finiseja laika ${s}s. +${e} punkti`;case"Mols":return`Zivs noķerta ${s}s laika! +${e} punkti`;default:return`Pabeigts! +${e} punkti`}}function qs(a){switch(a){case"RTU":return"Laiks beidzas! Megini velreiz.";case"Osta":return"Diemzel neizdevās. Megini velreiz.";case"Mols":return"Aukla partruka! Megini velreiz.";default:return"Neizdevās. Megini velreiz."}}const Us="_title_1oj3h_1",Vs="_desc_1oj3h_2",Hs="_warn_1oj3h_3",Ws="_list_1oj3h_4",Zs="_item_1oj3h_6",Js="_num_1oj3h_18",Xs="_text_1oj3h_19",Ys="_arrows_1oj3h_21",Qs="_arrowBtn_1oj3h_22",ei="_btnRow_1oj3h_38",ti="_btn_1oj3h_38",si="_resetBtn_1oj3h_55",ii="_success_1oj3h_69",ai="_fact_1oj3h_70",P={title:Us,desc:Vs,warn:Hs,list:Ws,item:Zs,num:Js,text:Xs,arrows:Ys,arrowBtn:Qs,btnRow:ei,btn:ti,resetBtn:si,success:ii,fact:ai},je=[{year:1625,text:"Liepaja iegust pilsetas tiesibas"},{year:1907,text:"Dibināts Liepajas Teatris"},{year:2015,text:'Atklata koncertzale "Lielais Dzintars"'}];function ve(a){const e=[...a];for(let s=e.length-1;s>0;s--){const i=Math.floor(Math.random()*(s+1));[e[s],e[i]]=[e[i],e[s]]}return e}function ni({open:a,onComplete:e,onClose:s}){const{addScore:i,antiCheat:o,notify:n}=W(),[l,u]=r.useState(()=>ve(je)),[f,_]=r.useState("play"),[b,c]=r.useState(!1),m=(p,k)=>{if(p+k<0||p+k>=l.length)return;const g=[...l];[g[p],g[p+k]]=[g[p+k],g[p]],u(g)},d=()=>{if(!o.validateAnswerSubmission()){n("Atbilde iesniegta pārstak atri!","warning");return}l.every((k,g)=>g===0||k.year>=l[g-1].year)?(i(10),o.recordTaskEnd("Teatris",10),_("success"),n("+10 punkti!","success",2e3)):(c(!0),n("Nepareiza seciba! Megini velreiz.","error",2500),o.recordTaskStart("Teatris"))},v=()=>{u(ve(je)),c(!1),o.recordTaskStart("Teatris")};return t.jsx(J,{open:a,onClose:f==="success"?s:void 0,children:t.jsxs("div",{"data-game":!0,children:[t.jsx("h2",{className:P.title,children:"Vesturiska seciba"}),f==="play"?t.jsxs(t.Fragment,{children:[t.jsx("p",{className:P.desc,children:"Sakarto notikumus hronologiska seciba (no senaka uz jaunako)!"}),b&&t.jsx("p",{className:P.warn,children:"Seciba nav pareiza. Megini velreiz."}),t.jsx("div",{className:P.list,children:l.map((p,k)=>t.jsxs("div",{className:P.item,children:[t.jsxs("span",{className:P.num,children:[k+1,"."]}),t.jsx("span",{className:P.text,children:p.text}),t.jsxs("div",{className:P.arrows,children:[t.jsx("button",{className:P.arrowBtn,onClick:()=>m(k,-1),disabled:k===0,"aria-label":"Uz augšu",children:"^"}),t.jsx("button",{className:P.arrowBtn,onClick:()=>m(k,1),disabled:k===l.length-1,"aria-label":"Uz leju",children:"v"})]})]},p.year))}),t.jsxs("div",{className:P.btnRow,children:[t.jsx("button",{className:P.btn,onClick:d,children:"Iesniegt secību"}),b&&t.jsx("button",{className:P.resetBtn,onClick:v,children:"Atiestatit"})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("p",{className:P.success,children:"Pareizi! +10 punkti"}),t.jsx("p",{className:P.fact,children:"Pareiza seciba: 1625, 1907, 2015"}),t.jsx("button",{className:P.btn,onClick:()=>e(10),children:"Turpinat"})]})]})})}const oi="_root_123wo_1",ri="_title_123wo_2",ci="_medalLine_123wo_3",li="_scoreBox_123wo_5",di="_scoreRow_123wo_15",ui="_scoreLabel_123wo_16",hi="_scoreValue_123wo_17",mi="_finishedMsg_123wo_19",pi="_btnGroup_123wo_21",_i="_btn_123wo_21",fi="_btnSaved_123wo_39",gi="_btnSecondary_123wo_41",z={root:oi,title:ri,medalLine:ci,scoreBox:li,scoreRow:di,scoreLabel:ui,scoreValue:hi,finishedMsg:mi,btnGroup:pi,btn:_i,btnSaved:fi,btnSecondary:gi},me="_scoreSaved";function bi({open:a,score:e,startTime:s,playerName:i,onClose:o}){const{antiCheat:n,notify:l,gameState:u}=W(),[f,_]=r.useState(!1),[b,c]=r.useState(!1),m=Math.floor((Date.now()-(s||Date.now()))/1e3),d=Math.floor(m/60),v=m%60,p=`${String(d).padStart(2,"0")}:${String(v).padStart(2,"0")}`,k=e>=80?"Zelta":e>=50?"Sudrabota":"Bronzas",g=r.useCallback(async()=>{if(f||b)return;if(sessionStorage.getItem(me)===n.sessionId){l("Rezultats jau saglabats!","info",2e3),_(!0);return}c(!0);try{const F=n.buildSubmitPayload(e,te,m),E=new FormData;E.append("name",i||"Anonims"),E.append("score",e),E.append("time",p),E.append("token",F.token),E.append("tasks",te),E.append("violations",F.violations);const N=await(await fetch("../src/php/save_score.php",{method:"POST",body:E})).text();N.startsWith("Success")||N.trim()==="Success"?(sessionStorage.setItem(me,n.sessionId),u.clearSession(),_(!0),l("Rezultats saglabats!","success",2e3)):l(`Kludda: ${N.substring(0,60)}`,"error")}catch{l("Savienojuma kludda.","error")}finally{c(!1)}},[f,b,e,p,i,n,m,l,u]),S=()=>{window.location.href="../src/php/leaderboard.php"},C=()=>{u.clearSession();try{sessionStorage.removeItem(me)}catch{}o()};return t.jsx(J,{open:a,children:t.jsxs("div",{className:z.root,"data-game":!0,children:[t.jsx("h2",{className:z.title,children:"Apsveicam!"}),t.jsxs("p",{className:z.medalLine,children:[k," rezultats"]}),t.jsxs("div",{className:z.scoreBox,children:[t.jsxs("div",{className:z.scoreRow,children:[t.jsx("span",{className:z.scoreLabel,children:"Punkti"}),t.jsxs("span",{className:z.scoreValue,children:[e," / 100"]})]}),t.jsxs("div",{className:z.scoreRow,children:[t.jsx("span",{className:z.scoreLabel,children:"Laiks"}),t.jsx("span",{className:z.scoreValue,children:p})]})]}),t.jsx("p",{className:z.finishedMsg,children:"Tu esi pabeidzis ekskursiju pa Liepajas pilsetu!"}),t.jsxs("div",{className:z.btnGroup,children:[f?t.jsx("button",{className:`${z.btn} ${z.btnSaved}`,onClick:S,children:"Skatit Top 10"}):t.jsx("button",{className:z.btn,onClick:g,disabled:b,children:b?"Saglabajas...":"Saglabat rezultatu"}),t.jsx("button",{className:z.btnSecondary,onClick:C,children:"Jauna spele"}),t.jsx("button",{className:z.btnSecondary,onClick:()=>{u.clearSession(),o()},children:"Atpakal uz menu"})]})]})})}const ki="_root_1bdw5_1",xi="_topbar_1bdw5_9",Si="_topBtn_1bdw5_22",ji="_topRight_1bdw5_38",vi="_scoreDisplay_1bdw5_40",Ti="_mapContainer_1bdw5_47",yi="_mapArea_1bdw5_57",Ei="_point_1bdw5_70",Ni="_active_1bdw5_89",wi="_radarPulse_1bdw5_1",Ci="_done_1bdw5_94",Li="_locked_1bdw5_102",Ii="_legend_1bdw5_116",zi="_legendTitle_1bdw5_130",Ai="_legendItem_1bdw5_139",Oi="_dot_1bdw5_148",Mi="_tooltip_1bdw5_157",j={root:ki,topbar:xi,topBtn:Si,topRight:ji,scoreDisplay:vi,mapContainer:Ti,mapArea:yi,point:Ei,"color-green":"_color-green_1bdw5_84","color-blue":"_color-blue_1bdw5_85","color-red":"_color-red_1bdw5_86","color-yellow":"_color-yellow_1bdw5_87",active:Ni,radarPulse:wi,done:Ci,locked:Li,legend:Ii,legendTitle:zi,legendItem:Ai,dot:Oi,tooltip:Mi},Ri=new Set(["RTU","Osta","Mols"]),Pi=new Set(["Teatris"]),Di=[{id:"Mols",color:"yellow",top:"12%",left:"11%",label:"Ziemelu mols"},{id:"Cietums",color:"green",top:"24%",left:"44%",label:"Karostas cietums"},{id:"Kanals",color:"blue",top:"58%",left:"23%",label:"Tirdzniecibas kanals"},{id:"Dzintars",color:"blue",top:"61.5%",left:"30.5%",label:"Lielais Dzintars"},{id:"RTU",color:"blue",top:"63%",left:"27%",label:"RTU Liepaja"},{id:"Teatris",color:"blue",top:"64%",left:"37%",label:"Liepajas Teatris"},{id:"Osta",color:"red",top:"60%",left:"33%",label:"Liepajas Osta"},{id:"Parks",color:"green",top:"70%",left:"12%",label:"Jurmalas parks"},{id:"LSEZ",color:"red",top:"61.5%",left:"52.5%",label:"LSEZ"},{id:"Ezerkrasts",color:"green",top:"81%",left:"57%",label:"Ezerkrasta taka"}];function Bi(){const{state:a,dispatch:e,completeTask:s,notify:i,TOTAL_TASKS:o,taskSequence:n,antiCheat:l}=W(),u=Te(),[f,_]=r.useState(null),[b,c]=r.useState(!1),[m,d]=r.useState(!1),[v,p]=r.useState(!1),[k,g]=r.useState({visible:!1,text:"",x:0,y:0}),{completedTasks:S,score:C,startTime:$,playerName:F}=a;r.useEffect(()=>{S>=o&&!v&&p(!0)},[S,o,v]);const E=r.useCallback(y=>{const B=n.indexOf(y);return B<S?"done":B===S?"active":"locked"},[S,n]),I=r.useCallback(y=>{if(n.indexOf(y)!==S){i("Veic uzdevumus pec kartas!","warning");return}e({type:"SET_LOCATION",location:y}),Ri.has(y)?_("minigame"):Pi.has(y)?_("history"):_("quiz")},[S,n,e,i]),N=r.useCallback(y=>{const B=s();_(null),B>=o&&setTimeout(()=>p(!0),400)},[s,o]);return t.jsxs("div",{className:j.root,children:[t.jsxs("nav",{className:j.topbar,children:[t.jsx("button",{className:j.topBtn,onClick:()=>u("/"),children:"Atpakal"}),t.jsxs("span",{className:j.scoreDisplay,children:["Punkti: ",C]}),t.jsxs("div",{className:j.topRight,children:[t.jsx("button",{className:j.topBtn,onClick:()=>c(!0),children:"Iestatijumi"}),t.jsx("button",{className:j.topBtn,onClick:()=>d(!0),children:"Par speli"})]})]}),t.jsxs("div",{className:j.mapContainer,children:[t.jsx("div",{className:j.mapArea,children:Di.map(y=>{const B=E(y.id);return t.jsx("button",{className:`${j.point} ${j[`color-${y.color}`]} ${j[B]}`,style:{top:y.top,left:y.left},onClick:()=>B==="active"&&I(y.id),onMouseEnter:K=>g({visible:!0,text:y.label,x:K.clientX+14,y:K.clientY+14}),onMouseMove:K=>g(A=>({...A,x:K.clientX+14,y:K.clientY+14})),onMouseLeave:()=>g(K=>({...K,visible:!1})),"aria-label":y.label,disabled:B!=="active","data-game":!0},y.id)})}),t.jsxs("div",{className:j.legend,children:[t.jsx("p",{className:j.legendTitle,children:"Apskates vietas"}),t.jsxs("div",{className:j.legendItem,children:[t.jsx("span",{className:`${j.dot} ${j["color-green"]}`}),"Daba un atputa"]}),t.jsxs("div",{className:j.legendItem,children:[t.jsx("span",{className:`${j.dot} ${j["color-blue"]}`}),"Kultura un vesture"]}),t.jsxs("div",{className:j.legendItem,children:[t.jsx("span",{className:`${j.dot} ${j["color-yellow"]}`}),"RTU akademija"]}),t.jsxs("div",{className:j.legendItem,children:[t.jsx("span",{className:`${j.dot} ${j["color-red"]}`}),"Industrija un osta"]})]})]}),k.visible&&t.jsx("div",{className:j.tooltip,style:{top:k.y,left:k.x},children:k.text}),t.jsx(Ns,{open:f==="quiz",location:a.currentLocation,onComplete:N,onClose:()=>_(null)}),t.jsx(Gs,{open:f==="minigame",location:a.currentLocation,onComplete:N,onClose:()=>_(null)}),t.jsx(ni,{open:f==="history",onComplete:N,onClose:()=>_(null)}),t.jsx(Ie,{open:b,onClose:()=>c(!1)}),t.jsx(ze,{open:m,onClose:()=>d(!1)}),t.jsx(bi,{open:v,score:C,startTime:$,playerName:F,onClose:()=>u("/")}),t.jsx(Ae,{})]})}function $i(){return t.jsx(st,{children:t.jsx(tt,{children:t.jsx(Re,{children:t.jsxs(Pe,{children:[t.jsx(oe,{path:"/",element:t.jsx(xe,{})}),t.jsx(oe,{path:"/play",element:t.jsx(Bi,{})}),t.jsx(oe,{path:"*",element:t.jsx(xe,{})})]})})})})}pe.createRoot(document.getElementById("root")).render(t.jsx(De.StrictMode,{children:t.jsx($i,{})}));
